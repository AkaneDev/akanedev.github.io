<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pixel Canvas</title>
<style>
body { display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh; background:#222; margin:0; }
#canvas { display:grid; grid-template-columns: repeat(32, 20px); grid-template-rows: repeat(32, 20px); gap:1px; margin-top:20px; }
.pixel { width:20px; height:20px; background:#111; cursor:pointer; }
#palette { display:flex; gap:5px; margin-top:10px; }
.color { width:30px; height:30px; cursor:pointer; border:2px solid #fff; }
</style>
</head>
<body>

<h1 style="color:white;">Pixel Canvas</h1>
<div id="palette">
  <div class="color" style="background:red;" data-color="red"></div>
  <div class="color" style="background:blue;" data-color="blue"></div>
  <div class="color" style="background:green;" data-color="green"></div>
  <div class="color" style="background:yellow;" data-color="yellow"></div>
  <div class="color" style="background:white;" data-color="white"></div>
</div>
<div id="canvas"></div>

<script>
const canvas = document.getElementById('canvas');
const apiPrefix = 'https://api.akanedev.au'; // Adjust if neede
const colors = document.querySelectorAll('.color');
let currentColor = 'red';
const gridSize = 32;

for(let i=0; i<gridSize*gridSize; i++){
    const pixel = document.createElement('div');
    pixel.className = 'pixel';
    pixel.dataset.index = i;
    canvas.appendChild(pixel);
}

colors.forEach(c => c.addEventListener('click', () => currentColor = c.dataset.color));

async function loadCanvas() {
    const res = await fetch(apiPrefix + '/place');
    const data = await res.json(); 
    Object.entries(data).forEach(([index, color]) => {
        const pixel = canvas.querySelector(`.pixel[data-index='${index}']`);
        if(pixel) pixel.style.background = color;
    });
}
loadCanvas();

canvas.addEventListener('click', async (e) => {
    if(e.target.classList.contains('pixel')){
        const index = e.target.dataset.index;
        e.target.style.background = currentColor;

        await fetch(apiPrefix + `/place/${index}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ color: currentColor })
        });
    }
});

setInterval(loadCanvas, 1000);
</script>

</body>
</html>
